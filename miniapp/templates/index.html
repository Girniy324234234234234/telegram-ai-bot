<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sticker Generator</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body style="background:#0f0f1a;color:white;text-align:center">

<div class="app">
  <h2>üé® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∏–∫–µ—Ä–∞</h2>

  <input id="text" placeholder="–ö–æ—Ç –≤ —à–∞–ø–∫–µ"
         style="padding:12px;width:80%;border-radius:12px">

  <br><br>

  <button onclick="generate()" style="padding:12px 24px">
    –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
  </button>

  <br><br>

  <img id="img" style="max-width:90%;display:none">
</div>

<script>
const tg = window.Telegram.WebApp
tg.expand()

async function generate() {
  const text = document.getElementById("text").value.trim()
  if (!text) return alert("–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ")

  const res = await fetch("/generate", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      text: text,
      chat_id: tg.initDataUnsafe.user.id
    })
  })

  if (!res.ok) return alert("–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏")

  const data = await res.json()
  if (!data.ok) return alert("–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏")

  const img = document.getElementById("img")
  img.src = "data:image/png;base64," + data.image
  img.style.display = "block"
}
</script>

</body>
</html>
